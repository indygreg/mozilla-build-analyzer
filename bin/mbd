# vim: set filetype=python:
# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

from __future__ import print_function, unicode_literals

import numpy
import os
import sys

import mach.main

CATEGORIES = {
    'downloading': {
        'short': 'File Downloading',
        'long': 'Download files from Mozilla servers into local storage.',
        'priority': 60,
    },
    'loading': {
        'short': 'Data Loading',
        'long': 'Load data into storage.',
        'priority': 50,
    },
    'builders': {
        'short': 'Builder Information',
        'long': 'View data on builders.',
        'priority': 40,
    },
    'builds': {
        'short': 'Build Information',
        'long': 'View data on builds.',
        'priority': 39,
    },
    'slaves': {
        'short': 'Slave Information',
        'long': 'View data on slaves.',
        'priority': 38,
    },
    'logs': {
        'short': 'Log Information',
        'long': 'View data from logs.',
        'priority': 37,
    },
    'cassandra': {
        'short': 'Manage Cassandra',
        'long': 'Low-level commands for manipulating data in Cassandra.',
        'priority': 10,
    },
}

m = mach.main.Mach(os.getcwd())
m.add_global_argument('--host', default='localhost',
    help='Cassandra host to connect to.')
m.add_global_argument('--port', default=9160, type=int,
    help='Cassandra port to connect to.')
m.add_global_argument('--keyspace', default='mozbuilddata',
    help='Cassandra keyspace to use.')

for category, meta in CATEGORIES.items():
    m.define_category(category, meta['short'], meta['long'],
        meta['priority'])

import mozbuilddata.commands

sys.exit(m.run(sys.argv[1:]))

